An algorithm modified from roofit/rf101_basics.C
